<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<title>1v1 · 相机上传 + 聊天（深色·黑白）</title>
<style>
  :root{
    /* 深色黑白系（可微调） */
    --bg:#0f1115;
    --panel:#12151c;
    --panel-2:#0d0f14;
    --text:#e9edf1;
    --sub:#97a1ad;
    --line:#1e2430;
    --brand:#6b8afd;
    --brand-weak:#2b3350;
    --mine:#1b2431;
    --peer:#151b24;
    --danger:#742a2a;
    --r:14px;
    --gap:10px;
    --safe:env(safe-area-inset-bottom);
    --max-bubble:72vw;
    --img-thumb:44vw;
    --img-thumb-lg:84vw;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--text);
    font:15px/1.5 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Noto Sans SC",sans-serif;
  }
  .wrap{height:100%;display:flex;flex-direction:column}
  /* ……（中间样式保持不变）…… */

  .toast.show{opacity:1}

  /* 新增隐藏样式 */
  .hide-by-role{ display:none !important; }
</style>

<div class="wrap">
  <!-- 顶部 -->
  <div class="top">
    <div class="top-row" id="joinRow">
      <input id="room" class="ipt" placeholder="房间ID（字母数字）" inputmode="latin">
      <button id="join" class="btn">加入/创建</button>
      <label class="chk" id="ttsWrap"><input id="ttsToggle" type="checkbox"> 朗读对方</label>
    </div>
    <div class="modes">
      <div class="seg" id="modeSeg">
        <button data-mode="only-peer" class="active">只放大对方</button>
        <button data-mode="all-small">全部缩略</button>
        <button data-mode="all-large">全部放大</button>
      </div>
    </div>
  </div>

  <!-- 消息列表 -->
  <div id="log"></div>

  <!-- 全屏预览 -->
  <div id="viewer" class="viewer"><img alt=""></div>

  <!-- 底部：工具 + 输入贴合 -->
  <div class="footer">
    <div class="toolbar">
      <button id="plusBtn" class="tbtn">更多</button>
      <button id="openCam" class="tbtn">相机</button>
      <button id="shot" class="tbtn">拍照上传</button>
      <button id="closeCam" class="tbtn danger">关闭相机</button>
    </div>
    <div class="composer">
      <input id="text" placeholder="发消息…（回车发送）">
      <button id="send">发送</button>
    </div>
  </div>

  <!-- + 面板 -->
  <div id="sheetMask" class="sheet-mask"></div>
  <section id="sheet" class="sheet" aria-hidden="true">
    <div class="sheet-grid">
      <div class="sheet-item" id="sheetTemplate">模板</div>
      <div class="sheet-item" id="sheetUpload">上传图片</div>
      <div class="sheet-item" id="sheetCamera">打开相机</div>
      <div class="sheet-item" id="sheetMode">切换图片模式</div>
    </div>
  </section>

  <!-- 相机全屏 -->
  <section id="camPane" class="cam-pane" aria-hidden="true">
    <video id="camView" playsinline muted></video>
    <div class="cam-controls">
      <button id="shootBtn" class="cam-btn">拍照并上传</button>
      <button id="closeCamBtn" class="cam-btn danger">关闭相机</button>
    </div>
  </section>

  <div id="toast" class="toast"></div>
</div>

<script type="module" src="chat.js"></script>
</html>
