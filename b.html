<!doctype html>
<html lang="zh-CN">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<title>CameraChat · B端</title>
<link rel="icon" href="data:,">
<style>
  :root{--bg:#0f1115;--panel:#12151c;--line:#1e2430;--text:#e9edf1;--sub:#97a1ad;--brand:#6b8afd;--safe:env(safe-area-inset-bottom)}
  html,body{height:100%}body{margin:0;background:var(--bg);color:var(--text);font:15px/1.5 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Noto Sans SC",sans-serif}
  .wrap{height:100%;display:flex;flex-direction:column}
  .top{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#0c0f14,var(--panel));border-bottom:1px solid var(--line);padding:8px 12px}
  .seg{display:flex;gap:6px}
  .seg button{background:#0d1016;border:1px solid var(--line);color:var(--text);padding:8px 12px;border-radius:999px}
  #log{flex:1;overflow:auto;padding:10px;display:flex;flex-direction:column;gap:8px}
  .row{display:flex}.row.peer{justify-content:flex-start}.row.self{justify-content:flex-end}
  .msg{max-width:72vw;background:#151b24;border:1px solid var(--line);padding:8px 10px;border-radius:12px}
  .self .msg{background:#1b2431}
  .msg p{margin:0;white-space:pre-wrap;word-break:break-word}
  .msg img{display:block;width:44vw;height:auto;border-radius:10px;border:1px solid var(--line)}
  .msg.enlarge img{width:min(84vw,520px)}
  .viewer{position:fixed;inset:0;background:rgba(0,0,0,.92);display:none;align-items:center;justify-content:center;z-index:999}
  .viewer img{max-width:100vw;max-height:100vh}.viewer.show{display:flex}

  /* 相机面板 */
  #camPane{position:fixed;inset:0;background:#000;display:none;z-index:1000}
  #camView{display:block;width:100%;height:50vh;max-height:60vh;background:#000;object-fit:cover}
  .camBar{position:absolute;left:0;right:0;bottom:0;padding:12px 12px calc(12px + var(--safe));display:flex;gap:10px;justify-content:center;background:linear-gradient(180deg,transparent,rgba(0,0,0,.6))}
  .btn{height:44px;border-radius:999px;border:0;padding:0 16px;font-weight:700}
  .btn.p{background:#1c2432;color:#fff;border:1px solid #2a3548}
  .btn.d{background:#5a1d1d;color:#fff;border:1px solid #7a3030}
  #lastThumb{position:absolute;left:12px;bottom:76px;width:72px;height:72px;border:1px solid rgba(255,255,255,.3);border-radius:10px;object-fit:cover;display:none}
</style>

<div class="wrap">
  <div class="top">
    <div class="seg">
      <button id="openCamBtn" class="segbtn">打开相机</button>
      <button id="pickBtn" class="segbtn">相册上传</button>
    </div>
  </div>

  <div id="log"></div>

  <div id="viewer" class="viewer"><img alt=""></div>
</div>

<!-- 相机面板 -->
<section id="camPane">
  <video id="camView" playsinline muted autoplay></video>
  <img id="lastThumb" alt="">
  <div class="camBar">
    <button id="shootBtn" class="btn p">拍照并上传</button>
    <button id="flipBtn"  class="btn p">前/后切换</button>
    <button id="closeCamBtn" class="btn d">关闭</button>
  </div>
</section>

<script type="module" src="b.js"></script>
</html>
